<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">  
    <title>患者主诉实体链接标注系统</title>
    <link rel="stylesheet" type="text/css" href="css_login.css"/> 
</head>
<body>
    <div id="login">  
        <h1>Login</h1>  
        <form method="get">  
            <input type="username" required="required" placeholder="用户名" id="username"></input>  
            <input type="password" required="required" placeholder="请输入密码（6-16位）" id="password"></input>
            <input type="password" required="required" placeholder="再次输入密码" id="password_confirm"></input>
            <button id="login_button" class="but" type="submit" onclick="onRegister()">注册</button>
        </form>  
    </div>  
</body>

<script>
// --- global variables
var username = "";
var password = "";
var password_confirm = "";
// --- end of global variables

// to do: security
// 1. Verification Code
// 2. Enable different type of register and type check: username (check ill-legal chars), mail (check valid mail) or phone (check valid phone number)
function onRegister() {
    username = document.getElementById('username').value;
    password = document.getElementById('password').value;
    password_confirm = document.getElementById('password_confirm').value;

    if (password != password_confirm) {
        alert("两次输入的密码不相同！");
    }

    var xhr = new XMLHttpRequest();
    xhr.timeout = 5000;
    xhr.ontimeout = function(event){
        alert('请求超时！');
    }
    xhr.open("get", "http://172.17.168.66:8008/?action=1000&username=" + username + "&password=" + password);
    xhr.send();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
            if (xhr.responseText == '1') {
                window.location.href = "./annotator.html";
            } else {
                alert("注册失败！");
            }
        }
    };
}
</script>
</html>